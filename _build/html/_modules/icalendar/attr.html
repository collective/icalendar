
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>icalendar.attr &#8212; icalendar 6.3.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=164cab21"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/icalendar/attr';</script>
    <script defer="defer" src="../../_static/js/custom-icons.js?v=c97652e3"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="6.3.2" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search"
         aria-label="Search"
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">icalendar 6.3.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../how-to/index.html">
    How to guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribute/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
            
          
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/collective/icalendar" title="GitHub" class="nav-link custom-fancy-css" rel="noopener me" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
            
          
            
          
            
          
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/icalendar" title="PyPI" class="nav-link custom-fancy-css" rel="noopener me" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../how-to/index.html">
    How to guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribute/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
            
          
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/collective/icalendar" title="GitHub" class="nav-link custom-fancy-css" rel="noopener me" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
            
          
            
          
            
          
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/icalendar" title="PyPI" class="nav-link custom-fancy-css" rel="noopener me" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">icalendar.attr</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for icalendar.attr</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Attributes of Components and properties.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">BUSYTYPE</span><span class="p">,</span> <span class="n">CLASS</span><span class="p">,</span> <span class="n">STATUS</span><span class="p">,</span> <span class="n">TRANSP</span><span class="p">,</span> <span class="n">StrEnum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.error</span><span class="w"> </span><span class="kn">import</span> <span class="n">IncompleteComponent</span><span class="p">,</span> <span class="n">InvalidCalendar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.parser_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">SEQUENCE_TYPES</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.prop</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">vCalAddress</span><span class="p">,</span>
    <span class="n">vCategory</span><span class="p">,</span>
    <span class="n">vDDDTypes</span><span class="p">,</span>
    <span class="n">vDuration</span><span class="p">,</span>
    <span class="n">vRecur</span><span class="p">,</span>
    <span class="n">vText</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.prop.conference</span><span class="w"> </span><span class="kn">import</span> <span class="n">Conference</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.prop.image</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.timezone</span><span class="w"> </span><span class="kn">import</span> <span class="n">tzp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_date</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">icalendar.cal</span><span class="w"> </span><span class="kn">import</span> <span class="n">Component</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_rdates</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">datetime</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The RDATE property defines the list of DATE-TIME values for recurring components.</span>

<span class="sd">    RDATE is defined in :rfc:`5545`.</span>
<span class="sd">    The return value is a list of tuples ``(start, end)``.</span>

<span class="sd">    ``start`` can be a :class:`datetime.date` or a :class:`datetime.datetime`,</span>
<span class="sd">    with and without timezone.</span>

<span class="sd">    ``end`` is :obj:`None` if the end is not specified and a :class:`datetime.datetime`</span>
<span class="sd">    if the end is specified.</span>

<span class="sd">    Value Type:</span>
<span class="sd">        The default value type for this property is DATE-TIME.</span>
<span class="sd">        The value type can be set to DATE or PERIOD.</span>

<span class="sd">    Property Parameters:</span>
<span class="sd">        IANA, non-standard, value data type, and time</span>
<span class="sd">        zone identifier property parameters can be specified on this</span>
<span class="sd">        property.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property can be specified in recurring &quot;VEVENT&quot;,</span>
<span class="sd">        &quot;VTODO&quot;, and &quot;VJOURNAL&quot; calendar components as well as in the</span>
<span class="sd">        &quot;STANDARD&quot; and &quot;DAYLIGHT&quot; sub-components of the &quot;VTIMEZONE&quot;</span>
<span class="sd">        calendar component.</span>

<span class="sd">    Description:</span>
<span class="sd">        This property can appear along with the &quot;RRULE&quot;</span>
<span class="sd">        property to define an aggregate set of repeating occurrences.</span>
<span class="sd">        When they both appear in a recurring component, the recurrence</span>
<span class="sd">        instances are defined by the union of occurrences defined by both</span>
<span class="sd">        the &quot;RDATE&quot; and &quot;RRULE&quot;.</span>

<span class="sd">        The recurrence dates, if specified, are used in computing the</span>
<span class="sd">        recurrence set.  The recurrence set is the complete set of</span>
<span class="sd">        recurrence instances for a calendar component.  The recurrence set</span>
<span class="sd">        is generated by considering the initial &quot;DTSTART&quot; property along</span>
<span class="sd">        with the &quot;RRULE&quot;, &quot;RDATE&quot;, and &quot;EXDATE&quot; properties contained</span>
<span class="sd">        within the recurring component.  The &quot;DTSTART&quot; property defines</span>
<span class="sd">        the first instance in the recurrence set.  The &quot;DTSTART&quot; property</span>
<span class="sd">        value SHOULD match the pattern of the recurrence rule, if</span>
<span class="sd">        specified.  The recurrence set generated with a &quot;DTSTART&quot; property</span>
<span class="sd">        value that doesn&#39;t match the pattern of the rule is undefined.</span>
<span class="sd">        The final recurrence set is generated by gathering all of the</span>
<span class="sd">        start DATE-TIME values generated by any of the specified &quot;RRULE&quot;</span>
<span class="sd">        and &quot;RDATE&quot; properties, and then excluding any start DATE-TIME</span>
<span class="sd">        values specified by &quot;EXDATE&quot; properties.  This implies that start</span>
<span class="sd">        DATE-TIME values specified by &quot;EXDATE&quot; properties take precedence</span>
<span class="sd">        over those specified by inclusion properties (i.e., &quot;RDATE&quot; and</span>
<span class="sd">        &quot;RRULE&quot;).  Where duplicate instances are generated by the &quot;RRULE&quot;</span>
<span class="sd">        and &quot;RDATE&quot; properties, only one recurrence is considered.</span>
<span class="sd">        Duplicate instances are ignored.</span>

<span class="sd">    Example:</span>
<span class="sd">        Below, we set one RDATE in a list and get the resulting tuple of start and end.</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Event</span>
<span class="sd">            &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">            &gt;&gt;&gt; event = Event()</span>

<span class="sd">            # Add a list of recurrence dates</span>
<span class="sd">            &gt;&gt;&gt; event.add(&quot;RDATE&quot;, [datetime(2025, 4, 28, 16, 5)])</span>
<span class="sd">            &gt;&gt;&gt; event.rdates</span>
<span class="sd">            [(datetime.datetime(2025, 4, 28, 16, 5), None)]</span>

<span class="sd">    .. note::</span>

<span class="sd">        You cannot modify the RDATE value by modifying the result.</span>
<span class="sd">        Use :func:`icalendar.cal.Component.add` to add values.</span>

<span class="sd">        If you want to compute recurrences, have a look at :ref:`Related projects`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rdates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;RDATE&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">for</span> <span class="n">rdates</span> <span class="ow">in</span> <span class="p">(</span><span class="n">rdates</span><span class="p">,)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rdates</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">rdates</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dts</span> <span class="ow">in</span> <span class="n">rdates</span><span class="o">.</span><span class="n">dts</span><span class="p">:</span>
            <span class="n">rdate</span> <span class="o">=</span> <span class="n">dts</span><span class="o">.</span><span class="n">dt</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rdate</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="c1"># we have a period as rdate</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rdate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">timedelta</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rdate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rdate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rdate</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># we have a date/datetime</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rdate</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="n">rdates_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rdates</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_exdates</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;EXDATE defines the list of DATE-TIME exceptions for recurring components.</span>

<span class="sd">    EXDATE is defined in :rfc:`5545`.</span>

<span class="sd">    Value Type:</span>
<span class="sd">        The default value type for this property is DATE-TIME.</span>
<span class="sd">        The value type can be set to DATE.</span>

<span class="sd">    Property Parameters:</span>
<span class="sd">        IANA, non-standard, value data type, and time</span>
<span class="sd">        zone identifier property parameters can be specified on this</span>
<span class="sd">        property.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property can be specified in recurring &quot;VEVENT&quot;,</span>
<span class="sd">        &quot;VTODO&quot;, and &quot;VJOURNAL&quot; calendar components as well as in the</span>
<span class="sd">        &quot;STANDARD&quot; and &quot;DAYLIGHT&quot; sub-components of the &quot;VTIMEZONE&quot;</span>
<span class="sd">        calendar component.</span>

<span class="sd">    Description:</span>
<span class="sd">        The exception dates, if specified, are used in</span>
<span class="sd">        computing the recurrence set.  The recurrence set is the complete</span>
<span class="sd">        set of recurrence instances for a calendar component.  The</span>
<span class="sd">        recurrence set is generated by considering the initial &quot;DTSTART&quot;</span>
<span class="sd">        property along with the &quot;RRULE&quot;, &quot;RDATE&quot;, and &quot;EXDATE&quot; properties</span>
<span class="sd">        contained within the recurring component.  The &quot;DTSTART&quot; property</span>
<span class="sd">        defines the first instance in the recurrence set.  The &quot;DTSTART&quot;</span>
<span class="sd">        property value SHOULD match the pattern of the recurrence rule, if</span>
<span class="sd">        specified.  The recurrence set generated with a &quot;DTSTART&quot; property</span>
<span class="sd">        value that doesn&#39;t match the pattern of the rule is undefined.</span>
<span class="sd">        The final recurrence set is generated by gathering all of the</span>
<span class="sd">        start DATE-TIME values generated by any of the specified &quot;RRULE&quot;</span>
<span class="sd">        and &quot;RDATE&quot; properties, and then excluding any start DATE-TIME</span>
<span class="sd">        values specified by &quot;EXDATE&quot; properties.  This implies that start</span>
<span class="sd">        DATE-TIME values specified by &quot;EXDATE&quot; properties take precedence</span>
<span class="sd">        over those specified by inclusion properties (i.e., &quot;RDATE&quot; and</span>
<span class="sd">        &quot;RRULE&quot;).  When duplicate instances are generated by the &quot;RRULE&quot;</span>
<span class="sd">        and &quot;RDATE&quot; properties, only one recurrence is considered.</span>
<span class="sd">        Duplicate instances are ignored.</span>

<span class="sd">        The &quot;EXDATE&quot; property can be used to exclude the value specified</span>
<span class="sd">        in &quot;DTSTART&quot;.  However, in such cases, the original &quot;DTSTART&quot; date</span>
<span class="sd">        MUST still be maintained by the calendaring and scheduling system</span>
<span class="sd">        because the original &quot;DTSTART&quot; value has inherent usage</span>
<span class="sd">        dependencies by other properties such as the &quot;RECURRENCE-ID&quot;.</span>

<span class="sd">    Example:</span>
<span class="sd">        Below, we add an exdate in a list and get the resulting list of exdates.</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Event</span>
<span class="sd">            &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">            &gt;&gt;&gt; event = Event()</span>

<span class="sd">            # Add a list of excluded dates</span>
<span class="sd">            &gt;&gt;&gt; event.add(&quot;EXDATE&quot;, [datetime(2025, 4, 28, 16, 5)])</span>
<span class="sd">            &gt;&gt;&gt; event.exdates</span>
<span class="sd">            [datetime.datetime(2025, 4, 28, 16, 5)]</span>

<span class="sd">    .. note::</span>

<span class="sd">        You cannot modify the EXDATE value by modifying the result.</span>
<span class="sd">        Use :func:`icalendar.cal.Component.add` to add values.</span>

<span class="sd">        If you want to compute recurrences, have a look at :ref:`Related projects`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">exdates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EXDATE&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">for</span> <span class="n">exdates</span> <span class="ow">in</span> <span class="p">(</span><span class="n">exdates</span><span class="p">,)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exdates</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">exdates</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dts</span> <span class="ow">in</span> <span class="n">exdates</span><span class="o">.</span><span class="n">dts</span><span class="p">:</span>
            <span class="n">exdate</span> <span class="o">=</span> <span class="n">dts</span><span class="o">.</span><span class="n">dt</span>
            <span class="c1"># we have a date/datetime</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exdate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="n">exdates_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_exdates</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_rrules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">vRecur</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;RRULE defines a rule or repeating pattern for recurring components.</span>

<span class="sd">    RRULE is defined in :rfc:`5545`.</span>
<span class="sd">    :rfc:`7529` adds the ``SKIP`` parameter :class:`icalendar.prop.vSkip`.</span>

<span class="sd">    Property Parameters:</span>
<span class="sd">        IANA and non-standard property parameters can</span>
<span class="sd">        be specified on this property.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property can be specified in recurring &quot;VEVENT&quot;,</span>
<span class="sd">        &quot;VTODO&quot;, and &quot;VJOURNAL&quot; calendar components as well as in the</span>
<span class="sd">        &quot;STANDARD&quot; and &quot;DAYLIGHT&quot; sub-components of the &quot;VTIMEZONE&quot;</span>
<span class="sd">        calendar component, but it SHOULD NOT be specified more than once.</span>
<span class="sd">        The recurrence set generated with multiple &quot;RRULE&quot; properties is</span>
<span class="sd">        undefined.</span>

<span class="sd">    Description:</span>
<span class="sd">        The recurrence rule, if specified, is used in computing</span>
<span class="sd">        the recurrence set.  The recurrence set is the complete set of</span>
<span class="sd">        recurrence instances for a calendar component.  The recurrence set</span>
<span class="sd">        is generated by considering the initial &quot;DTSTART&quot; property along</span>
<span class="sd">        with the &quot;RRULE&quot;, &quot;RDATE&quot;, and &quot;EXDATE&quot; properties contained</span>
<span class="sd">        within the recurring component.  The &quot;DTSTART&quot; property defines</span>
<span class="sd">        the first instance in the recurrence set.  The &quot;DTSTART&quot; property</span>
<span class="sd">        value SHOULD be synchronized with the recurrence rule, if</span>
<span class="sd">        specified.  The recurrence set generated with a &quot;DTSTART&quot; property</span>
<span class="sd">        value not synchronized with the recurrence rule is undefined.  The</span>
<span class="sd">        final recurrence set is generated by gathering all of the start</span>
<span class="sd">        DATE-TIME values generated by any of the specified &quot;RRULE&quot; and</span>
<span class="sd">        &quot;RDATE&quot; properties, and then excluding any start DATE-TIME values</span>
<span class="sd">        specified by &quot;EXDATE&quot; properties.  This implies that start DATE-</span>
<span class="sd">        TIME values specified by &quot;EXDATE&quot; properties take precedence over</span>
<span class="sd">        those specified by inclusion properties (i.e., &quot;RDATE&quot; and</span>
<span class="sd">        &quot;RRULE&quot;).  Where duplicate instances are generated by the &quot;RRULE&quot;</span>
<span class="sd">        and &quot;RDATE&quot; properties, only one recurrence is considered.</span>
<span class="sd">        Duplicate instances are ignored.</span>

<span class="sd">        The &quot;DTSTART&quot; property specified within the iCalendar object</span>
<span class="sd">        defines the first instance of the recurrence.  In most cases, a</span>
<span class="sd">        &quot;DTSTART&quot; property of DATE-TIME value type used with a recurrence</span>
<span class="sd">        rule, should be specified as a date with local time and time zone</span>
<span class="sd">        reference to make sure all the recurrence instances start at the</span>
<span class="sd">        same local time regardless of time zone changes.</span>

<span class="sd">        If the duration of the recurring component is specified with the</span>
<span class="sd">        &quot;DTEND&quot; or &quot;DUE&quot; property, then the same exact duration will apply</span>
<span class="sd">        to all the members of the generated recurrence set.  Else, if the</span>
<span class="sd">        duration of the recurring component is specified with the</span>
<span class="sd">        &quot;DURATION&quot; property, then the same nominal duration will apply to</span>
<span class="sd">        all the members of the generated recurrence set and the exact</span>
<span class="sd">        duration of each recurrence instance will depend on its specific</span>
<span class="sd">        start time.  For example, recurrence instances of a nominal</span>
<span class="sd">        duration of one day will have an exact duration of more or less</span>
<span class="sd">        than 24 hours on a day where a time zone shift occurs.  The</span>
<span class="sd">        duration of a specific recurrence may be modified in an exception</span>
<span class="sd">        component or simply by using an &quot;RDATE&quot; property of PERIOD value</span>
<span class="sd">        type.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Daily for 10 occurrences:</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Event</span>
<span class="sd">            &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">            &gt;&gt;&gt; from zoneinfo import ZoneInfo</span>
<span class="sd">            &gt;&gt;&gt; event = Event()</span>
<span class="sd">            &gt;&gt;&gt; event.start = datetime(1997, 9, 2, 9, 0, tzinfo=ZoneInfo(&quot;America/New_York&quot;))</span>
<span class="sd">            &gt;&gt;&gt; event.add(&quot;RRULE&quot;, &quot;FREQ=DAILY;COUNT=10&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(event.to_ical())</span>
<span class="sd">            BEGIN:VEVENT</span>
<span class="sd">            DTSTART;TZID=America/New_York:19970902T090000</span>
<span class="sd">            RRULE:FREQ=DAILY;COUNT=10</span>
<span class="sd">            END:VEVENT</span>
<span class="sd">            &gt;&gt;&gt; event.rrules</span>
<span class="sd">            [vRecur({&#39;FREQ&#39;: [&#39;DAILY&#39;], &#39;COUNT&#39;: [10]})]</span>

<span class="sd">        Daily until December 24, 1997:</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Event, vRecur</span>
<span class="sd">            &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">            &gt;&gt;&gt; from zoneinfo import ZoneInfo</span>
<span class="sd">            &gt;&gt;&gt; event = Event()</span>
<span class="sd">            &gt;&gt;&gt; event.start = datetime(1997, 9, 2, 9, 0, tzinfo=ZoneInfo(&quot;America/New_York&quot;))</span>
<span class="sd">            &gt;&gt;&gt; event.add(&quot;RRULE&quot;, vRecur({&quot;FREQ&quot;: [&quot;DAILY&quot;]}, until=datetime(1997, 12, 24, tzinfo=ZoneInfo(&quot;UTC&quot;))))</span>
<span class="sd">            &gt;&gt;&gt; print(event.to_ical())</span>
<span class="sd">            BEGIN:VEVENT</span>
<span class="sd">            DTSTART;TZID=America/New_York:19970902T090000</span>
<span class="sd">            RRULE:FREQ=DAILY;UNTIL=19971224T000000Z</span>
<span class="sd">            END:VEVENT</span>
<span class="sd">            &gt;&gt;&gt; event.rrules</span>
<span class="sd">            [vRecur({&#39;FREQ&#39;: [&#39;DAILY&#39;], &#39;UNTIL&#39;: [datetime.datetime(1997, 12, 24, 0, 0, tzinfo=ZoneInfo(key=&#39;UTC&#39;))]})]</span>

<span class="sd">    .. note::</span>

<span class="sd">        You cannot modify the RRULE value by modifying the result.</span>
<span class="sd">        Use :func:`icalendar.cal.Component.add` to add values.</span>

<span class="sd">        If you want to compute recurrences, have a look at :ref:`Related projects`.</span>

<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="n">rrules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;RRULE&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rrules</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">rrules</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rrules</span>


<span class="n">rrules_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rrules</span><span class="p">)</span>


<div class="viewcode-block" id="multi_language_text_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.multi_language_text_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">multi_language_text_property</span><span class="p">(</span>
    <span class="n">main_prop</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">compatibility_prop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">doc</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This creates a text property.</span>

<span class="sd">    This property can be defined several times with different ``LANGUAGE`` parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        main_prop (str): The property to set and get, such as ``NAME``</span>
<span class="sd">        compatibility_prop (str): An old property used before, such as ``X-WR-CALNAME``</span>
<span class="sd">        doc (str): The documentation string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the property&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">main_prop</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">compatibility_prop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">compatibility_prop</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;LANGUAGE&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the property.&quot;&quot;&quot;</span>
        <span class="n">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">main_prop</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the property.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">main_prop</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">compatibility_prop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">compatibility_prop</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="p">,</span> <span class="n">fset</span><span class="p">,</span> <span class="n">fdel</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span></div>



<div class="viewcode-block" id="single_int_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.single_int_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">single_int_property</span><span class="p">(</span><span class="n">prop</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a property for an int value that exists only once.</span>

<span class="sd">    Args:</span>
<span class="sd">        prop: The name of the property</span>
<span class="sd">        default: The default value</span>
<span class="sd">        doc: The documentation string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the property&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2"> must be an int&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the property.&quot;&quot;&quot;</span>
        <span class="n">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the property.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="p">,</span> <span class="n">fset</span><span class="p">,</span> <span class="n">fdel</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span></div>



<div class="viewcode-block" id="single_utc_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.single_utc_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">single_utc_property</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a property to access a value of datetime in UTC timezone.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: name of the property</span>
<span class="sd">        docs: documentation string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;The </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> property. datetime in UTC</span>

<span class="s2">    All values will be converted to a datetime in UTC.</span>
<span class="s2">    &quot;&quot;&quot;</span>
        <span class="o">+</span> <span class="n">docs</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">vText</span><span class="p">):</span>
            <span class="c1"># we might be in an attribute that is not typed</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">vDDDTypes</span><span class="o">.</span><span class="n">from_ical</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> must be a datetime in UTC, not </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tzp</span><span class="o">.</span><span class="n">localize_utc</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the value&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> takes a datetime in UTC, not </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tzp</span><span class="o">.</span><span class="n">localize_utc</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the property.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="p">,</span> <span class="n">fset</span><span class="p">,</span> <span class="n">fdel</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">docs</span><span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">single_string_property</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">other_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a property to access a single string value.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">other_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">other_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">result</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the value.</span>

<span class="sd">        Setting the value to None will delete it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the property.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">other_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="p">,</span> <span class="n">fset</span><span class="p">,</span> <span class="n">fdel</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">docs</span><span class="p">)</span>


<span class="n">color_property</span> <span class="o">=</span> <span class="n">single_string_property</span><span class="p">(</span>
    <span class="s2">&quot;COLOR&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This property specifies a color used for displaying the component.</span>

<span class="sd">    This implements :rfc:`7986` ``COLOR`` property.</span>

<span class="sd">    Property Parameters:</span>
<span class="sd">        IANA and non-standard property parameters can</span>
<span class="sd">        be specified on this property.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property can be specified once in an iCalendar</span>
<span class="sd">        object or in ``VEVENT``, ``VTODO``, or ``VJOURNAL`` calendar components.</span>

<span class="sd">    Description:</span>
<span class="sd">        This property specifies a color that clients MAY use</span>
<span class="sd">        when presenting the relevant data to a user.  Typically, this</span>
<span class="sd">        would appear as the &quot;background&quot; color of events or tasks.  The</span>
<span class="sd">        value is a case-insensitive color name taken from the CSS3 set of</span>
<span class="sd">        names, defined in Section 4.3 of `W3C.REC-css3-color-20110607 &lt;https://www.w3.org/TR/css-color-3/&gt;`_.</span>

<span class="sd">    Example:</span>
<span class="sd">        ``&quot;turquoise&quot;``, ``&quot;#ffffff&quot;``</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Todo</span>
<span class="sd">            &gt;&gt;&gt; todo = Todo()</span>
<span class="sd">            &gt;&gt;&gt; todo.color = &quot;green&quot;</span>
<span class="sd">            &gt;&gt;&gt; print(todo.to_ical())</span>
<span class="sd">            BEGIN:VTODO</span>
<span class="sd">            COLOR:green</span>
<span class="sd">            END:VTODO</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sequence_property</span> <span class="o">=</span> <span class="n">single_int_property</span><span class="p">(</span>
    <span class="s2">&quot;SEQUENCE&quot;</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This property defines the revision sequence number of the calendar component within a sequence of revisions.</span>

<span class="sd">Value Type:</span>
<span class="sd">    INTEGER</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA and non-standard property parameters can be specified on this property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    The property can be specified in &quot;VEVENT&quot;, &quot;VTODO&quot;, or</span>
<span class="sd">    &quot;VJOURNAL&quot; calendar component.</span>

<span class="sd">Description:</span>
<span class="sd">    When a calendar component is created, its sequence</span>
<span class="sd">    number is 0.  It is monotonically incremented by the &quot;Organizer&#39;s&quot;</span>
<span class="sd">    CUA each time the &quot;Organizer&quot; makes a significant revision to the</span>
<span class="sd">    calendar component.</span>

<span class="sd">    The &quot;Organizer&quot; includes this property in an iCalendar object that</span>
<span class="sd">    it sends to an &quot;Attendee&quot; to specify the current version of the</span>
<span class="sd">    calendar component.</span>

<span class="sd">    The &quot;Attendee&quot; includes this property in an iCalendar object that</span>
<span class="sd">    it sends to the &quot;Organizer&quot; to specify the version of the calendar</span>
<span class="sd">    component to which the &quot;Attendee&quot; is referring.</span>

<span class="sd">    A change to the sequence number is not the mechanism that an</span>
<span class="sd">    &quot;Organizer&quot; uses to request a response from the &quot;Attendees&quot;.  The</span>
<span class="sd">    &quot;RSVP&quot; parameter on the &quot;ATTENDEE&quot; property is used by the</span>
<span class="sd">    &quot;Organizer&quot; to indicate that a response from the &quot;Attendees&quot; is</span>
<span class="sd">    requested.</span>

<span class="sd">    Recurrence instances of a recurring component MAY have different</span>
<span class="sd">    sequence numbers.</span>

<span class="sd">Examples:</span>
<span class="sd">    The following is an example of this property for a calendar</span>
<span class="sd">    component that was just created by the &quot;Organizer&quot;:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        &gt;&gt;&gt; from icalendar import Event</span>
<span class="sd">        &gt;&gt;&gt; event = Event()</span>
<span class="sd">        &gt;&gt;&gt; event.sequence</span>
<span class="sd">        0</span>

<span class="sd">    The following is an example of this property for a calendar</span>
<span class="sd">    component that has been revised 10 different times by the</span>
<span class="sd">    &quot;Organizer&quot;:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        &gt;&gt;&gt; from icalendar import Calendar</span>
<span class="sd">        &gt;&gt;&gt; calendar = Calendar.example(&quot;issue_156_RDATE_with_PERIOD_TZID_khal&quot;)</span>
<span class="sd">        &gt;&gt;&gt; event = calendar.events[0]</span>
<span class="sd">        &gt;&gt;&gt; event.sequence</span>
<span class="sd">        10</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>  <span class="c1"># noqa: E501</span>
<span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_categories</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all the categories.&quot;&quot;&quot;</span>
    <span class="n">categories</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vCategory</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">vCategory</span><span class="p">]]</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CATEGORIES&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">_set_categories</span><span class="p">(</span>
            <span class="n">component</span><span class="p">,</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">cats</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_get_categories</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">categories</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">vCategory</span><span class="p">([])</span>
        <span class="n">component</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;CATEGORIES&quot;</span><span class="p">,</span> <span class="n">categories</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">categories</span><span class="o">.</span><span class="n">cats</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_set_categories</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">cats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the categories.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cats</span> <span class="ow">and</span> <span class="n">cats</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">_del_categories</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">component</span><span class="p">[</span><span class="s2">&quot;CATEGORIES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories</span> <span class="o">=</span> <span class="n">vCategory</span><span class="p">(</span><span class="n">cats</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cats</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">cats</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">cats</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">categories</span><span class="o">.</span><span class="n">cats</span><span class="p">)</span>
        <span class="n">categories</span><span class="o">.</span><span class="n">cats</span> <span class="o">=</span> <span class="n">cats</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_del_categories</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete the categories.&quot;&quot;&quot;</span>
    <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;CATEGORIES&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<span class="n">categories_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
    <span class="n">_get_categories</span><span class="p">,</span>
    <span class="n">_set_categories</span><span class="p">,</span>
    <span class="n">_del_categories</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This property defines the categories for a component.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, and language property parameters can be specified on this</span>
<span class="sd">    property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    The property can be specified within &quot;VEVENT&quot;, &quot;VTODO&quot;, or &quot;VJOURNAL&quot; calendar</span>
<span class="sd">    components.</span>
<span class="sd">    Since :rfc:`7986` it can also be defined on a &quot;VCALENDAR&quot; component.</span>

<span class="sd">Description:</span>
<span class="sd">    This property is used to specify categories or subtypes</span>
<span class="sd">    of the calendar component.  The categories are useful in searching</span>
<span class="sd">    for a calendar component of a particular type and category.</span>
<span class="sd">    Within the &quot;VEVENT&quot;, &quot;VTODO&quot;, or &quot;VJOURNAL&quot; calendar components,</span>
<span class="sd">    more than one category can be specified as a COMMA-separated list</span>
<span class="sd">    of categories.</span>

<span class="sd">Example:</span>
<span class="sd">    Below, we add the categories to an event:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        &gt;&gt;&gt; from icalendar import Event</span>
<span class="sd">        &gt;&gt;&gt; event = Event()</span>
<span class="sd">        &gt;&gt;&gt; event.categories = [&quot;Work&quot;, &quot;Meeting&quot;]</span>
<span class="sd">        &gt;&gt;&gt; print(event.to_ical())</span>
<span class="sd">        BEGIN:VEVENT</span>
<span class="sd">        CATEGORIES:Work,Meeting</span>
<span class="sd">        END:VEVENT</span>
<span class="sd">        &gt;&gt;&gt; event.categories.append(&quot;Lecture&quot;)</span>
<span class="sd">        &gt;&gt;&gt; event.categories == [&quot;Work&quot;, &quot;Meeting&quot;, &quot;Lecture&quot;]</span>
<span class="sd">        True</span>

<span class="sd">.. note::</span>

<span class="sd">   At present, we do not take the LANGUAGE parameter into account.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">vCalAddress</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get attendees.&quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ATTENDEE&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;ATTENDEE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vCalAddress</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">value</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_set_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">vCalAddress</span><span class="p">]</span> <span class="o">|</span> <span class="n">vCalAddress</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set attendees.&quot;&quot;&quot;</span>
    <span class="n">_del_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
    <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;ATTENDEE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_del_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all attendees.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ATTENDEE&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<span class="n">attendees_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
    <span class="n">_get_attendees</span><span class="p">,</span>
    <span class="n">_set_attendees</span><span class="p">,</span>
    <span class="n">_del_attendees</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ATTENDEE defines one or more &quot;Attendees&quot; within a calendar component.</span>

<span class="sd">Conformance:</span>
<span class="sd">    This property MUST be specified in an iCalendar object</span>
<span class="sd">    that specifies a group-scheduled calendar entity.  This property</span>
<span class="sd">    MUST NOT be specified in an iCalendar object when publishing the</span>
<span class="sd">    calendar information (e.g., NOT in an iCalendar object that</span>
<span class="sd">    specifies the publication of a calendar user&#39;s busy time, event,</span>
<span class="sd">    to-do, or journal).  This property is not specified in an</span>
<span class="sd">    iCalendar object that specifies only a time zone definition or</span>
<span class="sd">    that defines calendar components that are not group-scheduled</span>
<span class="sd">    components, but are components only on a single user&#39;s calendar.</span>

<span class="sd">Description:</span>
<span class="sd">    This property MUST only be specified within calendar</span>
<span class="sd">    components to specify participants, non-participants, and the</span>
<span class="sd">    chair of a group-scheduled calendar entity.  The property is</span>
<span class="sd">    specified within an &quot;EMAIL&quot; category of the &quot;VALARM&quot; calendar</span>
<span class="sd">    component to specify an email address that is to receive the email</span>
<span class="sd">    type of iCalendar alarm.</span>

<span class="sd">Examples:</span>
<span class="sd">    Add a new attendee to an existing event.</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        &gt;&gt;&gt; from icalendar import Event, vCalAddress</span>
<span class="sd">        &gt;&gt;&gt; event = Event()</span>
<span class="sd">        &gt;&gt;&gt; event.attendees.append(vCalAddress(&quot;mailto:me@my-domain.com&quot;))</span>
<span class="sd">        &gt;&gt;&gt; print(event.to_ical())</span>
<span class="sd">        BEGIN:VEVENT</span>
<span class="sd">        ATTENDEE:mailto:me@my-domain.com</span>
<span class="sd">        END:VEVENT</span>

<span class="sd">    Create an email alarm with several attendees:</span>

<span class="sd">        &gt;&gt;&gt; from icalendar import Alarm, vCalAddress</span>
<span class="sd">        &gt;&gt;&gt; alarm = Alarm.new(attendees = [</span>
<span class="sd">        ...     vCalAddress(&quot;mailto:me@my-domain.com&quot;),</span>
<span class="sd">        ...     vCalAddress(&quot;mailto:you@my-domain.com&quot;),</span>
<span class="sd">        ... ], summary = &quot;Email alarm&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(alarm.to_ical())</span>
<span class="sd">        BEGIN:VALARM</span>
<span class="sd">        ATTENDEE:mailto:me@my-domain.com</span>
<span class="sd">        ATTENDEE:mailto:you@my-domain.com</span>
<span class="sd">        SUMMARY:Email alarm</span>
<span class="sd">        END:VALARM</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">uid_property</span> <span class="o">=</span> <span class="n">single_string_property</span><span class="p">(</span>
    <span class="s2">&quot;UID&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;UID specifies the persistent, globally unique identifier for a component.</span>

<span class="sd">We recommend using :func:`uuid.uuid4` to generate new values.</span>

<span class="sd">Returns:</span>
<span class="sd">    The value of the UID property as a string or ``&quot;&quot;`` if no value is set.</span>

<span class="sd">Description:</span>
<span class="sd">    The &quot;UID&quot; itself MUST be a globally unique identifier.</span>
<span class="sd">    The generator of the identifier MUST guarantee that the identifier</span>
<span class="sd">    is unique.</span>

<span class="sd">    This is the method for correlating scheduling messages with the</span>
<span class="sd">    referenced &quot;VEVENT&quot;, &quot;VTODO&quot;, or &quot;VJOURNAL&quot; calendar component.</span>
<span class="sd">    The full range of calendar components specified by a recurrence</span>
<span class="sd">    set is referenced by referring to just the &quot;UID&quot; property value</span>
<span class="sd">    corresponding to the calendar component.  The &quot;RECURRENCE-ID&quot;</span>
<span class="sd">    property allows the reference to an individual instance within the</span>
<span class="sd">    recurrence set.</span>

<span class="sd">    This property is an important method for group-scheduling</span>
<span class="sd">    applications to match requests with later replies, modifications,</span>
<span class="sd">    or deletion requests.  Calendaring and scheduling applications</span>
<span class="sd">    MUST generate this property in &quot;VEVENT&quot;, &quot;VTODO&quot;, and &quot;VJOURNAL&quot;</span>
<span class="sd">    calendar components to assure interoperability with other group-</span>
<span class="sd">    scheduling applications.  This identifier is created by the</span>
<span class="sd">    calendar system that generates an iCalendar object.</span>

<span class="sd">    Implementations MUST be able to receive and persist values of at</span>
<span class="sd">    least 255 octets for this property, but they MUST NOT truncate</span>
<span class="sd">    values in the middle of a UTF-8 multi-octet sequence.</span>

<span class="sd">    :rfc:`7986` states that UID can be used, for</span>
<span class="sd">    example, to identify duplicate calendar streams that a client may</span>
<span class="sd">    have been given access to.  It can be used in conjunction with the</span>
<span class="sd">    &quot;LAST-MODIFIED&quot; property also specified on the &quot;VCALENDAR&quot; object</span>
<span class="sd">    to identify the most recent version of a calendar.</span>

<span class="sd">Conformance:</span>
<span class="sd">    :rfc:`5545` states that the &quot;UID&quot; property can be specified on &quot;VEVENT&quot;, &quot;VTODO&quot;,</span>
<span class="sd">    and &quot;VJOURNAL&quot; calendar components.</span>
<span class="sd">    :rfc:`7986` modifies the definition of the &quot;UID&quot; property to</span>
<span class="sd">    allow it to be defined in an iCalendar object.</span>
<span class="sd">    :rfc:`9074`  adds a &quot;UID&quot; property to &quot;VALARM&quot; components to allow a unique</span>
<span class="sd">    identifier to be specified. The value of this property can then be used</span>
<span class="sd">    to refer uniquely to the &quot;VALARM&quot; component.</span>

<span class="sd">    This property can be specified once only.</span>

<span class="sd">Security:</span>
<span class="sd">    :rfc:`7986` states that UID values MUST NOT include any data that</span>
<span class="sd">    might identify a user, host, domain, or any other security- or</span>
<span class="sd">    privacy-sensitive information.  It is RECOMMENDED that calendar user</span>
<span class="sd">    agents now generate &quot;UID&quot; values that are hex-encoded random</span>
<span class="sd">    Universally Unique Identifier (UUID) values as defined in</span>
<span class="sd">    Sections 4.4 and 4.5 of :rfc:`4122`.</span>
<span class="sd">    You can use the :mod:`uuid` module to generate new UUIDs.</span>

<span class="sd">Compatibility:</span>
<span class="sd">    For Alarms, ``X-ALARMUID`` is also considered.</span>

<span class="sd">Examples:</span>
<span class="sd">    The following is an example of such a property value:</span>
<span class="sd">    ``5FC53010-1267-4F8E-BC28-1D7AE55A7C99``.</span>

<span class="sd">    Set the UID of a calendar:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        &gt;&gt;&gt; from icalendar import Calendar</span>
<span class="sd">        &gt;&gt;&gt; from uuid import uuid4</span>
<span class="sd">        &gt;&gt;&gt; calendar = Calendar()</span>
<span class="sd">        &gt;&gt;&gt; calendar.uid = uuid4()</span>
<span class="sd">        &gt;&gt;&gt; print(calendar.to_ical())</span>
<span class="sd">        BEGIN:VCALENDAR</span>
<span class="sd">        UID:d755cef5-2311-46ed-a0e1-6733c9e15c63</span>
<span class="sd">        END:VCALENDAR</span>

<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">summary_property</span> <span class="o">=</span> <span class="n">multi_language_text_property</span><span class="p">(</span>
    <span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;SUMMARY defines a short summary or subject for the calendar component.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, alternate text</span>
<span class="sd">    representation, and language property parameters can be specified</span>
<span class="sd">    on this property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    The property can be specified in &quot;VEVENT&quot;, &quot;VTODO&quot;,</span>
<span class="sd">    &quot;VJOURNAL&quot;, or &quot;VALARM&quot; calendar components.</span>

<span class="sd">Description:</span>
<span class="sd">    This property is used in the &quot;VEVENT&quot;, &quot;VTODO&quot;, and</span>
<span class="sd">    &quot;VJOURNAL&quot; calendar components to capture a short, one-line</span>
<span class="sd">    summary about the activity or journal entry.</span>

<span class="sd">    This property is used in the &quot;VALARM&quot; calendar component to</span>
<span class="sd">    capture the subject of an EMAIL category of alarm.</span>

<span class="sd">Examples:</span>
<span class="sd">    The following is an example of this property:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        SUMMARY:Department Party</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">description_property</span> <span class="o">=</span> <span class="n">multi_language_text_property</span><span class="p">(</span>
    <span class="s2">&quot;DESCRIPTION&quot;</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DESCRIPTION provides a more complete description of the calendar component than that provided by the &quot;SUMMARY&quot; property.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, alternate text</span>
<span class="sd">    representation, and language property parameters can be specified</span>
<span class="sd">    on this property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    The property can be specified in the &quot;VEVENT&quot;, &quot;VTODO&quot;,</span>
<span class="sd">    &quot;VJOURNAL&quot;, or &quot;VALARM&quot; calendar components.  The property can be</span>
<span class="sd">    specified multiple times only within a &quot;VJOURNAL&quot; calendar</span>
<span class="sd">    component.</span>

<span class="sd">Description:</span>
<span class="sd">    This property is used in the &quot;VEVENT&quot; and &quot;VTODO&quot; to</span>
<span class="sd">    capture lengthy textual descriptions associated with the activity.</span>

<span class="sd">    This property is used in the &quot;VALARM&quot; calendar component to</span>
<span class="sd">    capture the display text for a DISPLAY category of alarm, and to</span>
<span class="sd">    capture the body text for an EMAIL category of alarm.</span>

<span class="sd">Examples:</span>
<span class="sd">    The following is an example of this property with formatted</span>
<span class="sd">    line breaks in the property value:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        DESCRIPTION:Meeting to provide technical review for &quot;Phoenix&quot;</span>
<span class="sd">         design.\\nHappy Face Conference Room. Phoenix design team</span>
<span class="sd">         MUST attend this meeting.\\nRSVP to team leader.</span>

<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>  <span class="c1"># noqa: E501</span>
<span class="p">)</span>


<div class="viewcode-block" id="create_single_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.create_single_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">create_single_property</span><span class="p">(</span>
    <span class="n">prop</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">value_attr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">value_type</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">],</span>
    <span class="n">type_def</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
    <span class="n">doc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">vProp</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">vDDDTypes</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a single property getter and setter.</span>

<span class="sd">    :param prop: The name of the property.</span>
<span class="sd">    :param value_attr: The name of the attribute to get the value from.</span>
<span class="sd">    :param value_type: The type of the value.</span>
<span class="sd">    :param type_def: The type of the property.</span>
<span class="sd">    :param doc: The docstring of the property.</span>
<span class="sd">    :param vProp: The type of the property from :mod:`icalendar.prop`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">p_get</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
        <span class="n">default</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple </span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2"> defined.&quot;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">result</span> <span class="k">if</span> <span class="n">value_attr</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">value_attr</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2"> must be either a &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; or &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">value_type</span><span class="p">)</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; not </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">p_set</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p_del</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Use </span><span class="si">{</span><span class="s1">&#39; or &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">value_type</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">vProp</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclusive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">other_prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclusive</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">other_prop</span> <span class="o">!=</span> <span class="n">prop</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">other_prop</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">p_set</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_get</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;return&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">type_def</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">p_del</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="n">p_doc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;The </span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2"> property.</span>

<span class="s2">    </span><span class="si">{</span><span class="n">doc</span><span class="si">}</span>

<span class="s2">    Accepted values: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">value_type</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span>
<span class="s2">    If the attribute has invalid values, we raise InvalidCalendar.</span>
<span class="s2">    If the value is absent, we return None.</span>
<span class="s2">    You can also delete the value with del or by setting it to None.</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">p_get</span><span class="p">,</span> <span class="n">p_set</span><span class="p">,</span> <span class="n">p_del</span><span class="p">,</span> <span class="n">p_doc</span><span class="p">)</span></div>



<span class="n">X_MOZ_SNOOZE_TIME_property</span> <span class="o">=</span> <span class="n">single_utc_property</span><span class="p">(</span>
    <span class="s2">&quot;X-MOZ-SNOOZE-TIME&quot;</span><span class="p">,</span> <span class="s2">&quot;Thunderbird: Alarms before this time are snoozed.&quot;</span>
<span class="p">)</span>
<span class="n">X_MOZ_LASTACK_property</span> <span class="o">=</span> <span class="n">single_utc_property</span><span class="p">(</span>
    <span class="s2">&quot;X-MOZ-LASTACK&quot;</span><span class="p">,</span> <span class="s2">&quot;Thunderbird: Alarms before this time are acknowledged.&quot;</span>
<span class="p">)</span>


<div class="viewcode-block" id="property_get_duration">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.property_get_duration">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">property_get_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Getter for property DURATION.&quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">vDDDTypes</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">duration</span><span class="o">.</span><span class="n">dt</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">vDuration</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">duration</span><span class="o">.</span><span class="n">td</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">default</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;DURATION must be a timedelta, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="property_set_duration">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.property_set_duration">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">property_set_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Setter for property DURATION.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Use timedelta, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vDuration</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;DTEND&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;DUE&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="property_del_duration">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.property_del_duration">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">property_del_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete property DURATION.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;DURATION&quot;</span><span class="p">)</span></div>



<span class="n">property_doc_duration_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;The DURATION property.</span>

<span class="s2">The &quot;DTSTART&quot; property for a &quot;</span><span class="si">{component}</span><span class="s2">&quot; specifies the inclusive</span>
<span class="s2">start of the </span><span class="si">{component}</span><span class="s2">.</span>
<span class="s2">The &quot;DURATION&quot; property in conjunction with the DTSTART property</span>
<span class="s2">for a &quot;</span><span class="si">{component}</span><span class="s2">&quot; calendar component specifies the non-inclusive end</span>
<span class="s2">of the event.</span>

<span class="s2">If you would like to calculate the duration of a </span><span class="si">{component}</span><span class="s2">, do not use this.</span>
<span class="s2">Instead use the duration property (lower case).</span>
<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="duration_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.duration_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">duration_property</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the duration property.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">property_get_duration</span><span class="p">,</span>
        <span class="n">property_set_duration</span><span class="p">,</span>
        <span class="n">property_del_duration</span><span class="p">,</span>
        <span class="n">property_doc_duration_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">),</span>
    <span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">multi_text_property</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a property that can occur several times and is text.</span>

<span class="sd">    Examples: Journal.descriptions, Event.comments</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the values.&quot;&quot;&quot;</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">descriptions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="n">SEQUENCE_TYPES</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">descriptions</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">descriptions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the values.&quot;&quot;&quot;</span>
        <span class="n">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fdel</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the values.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="p">,</span> <span class="n">fset</span><span class="p">,</span> <span class="n">fdel</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span>


<span class="n">descriptions_property</span> <span class="o">=</span> <span class="n">multi_text_property</span><span class="p">(</span>
    <span class="s2">&quot;DESCRIPTION&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DESCRIPTION provides a more complete description of the calendar component than that provided by the &quot;SUMMARY&quot; property.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, alternate text</span>
<span class="sd">    representation, and language property parameters can be specified</span>
<span class="sd">    on this property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    The property can be</span>
<span class="sd">    specified multiple times only within a &quot;VJOURNAL&quot; calendar component.</span>

<span class="sd">Description:</span>
<span class="sd">    This property is used in the &quot;VJOURNAL&quot; calendar component to</span>
<span class="sd">    capture one or more textual journal entries.</span>

<span class="sd">Examples:</span>
<span class="sd">    The following is an example of this property with formatted</span>
<span class="sd">    line breaks in the property value:</span>

<span class="sd">    .. code-block:: pycon</span>

<span class="sd">        DESCRIPTION:Meeting to provide technical review for &quot;Phoenix&quot;</span>
<span class="sd">         design.\\nHappy Face Conference Room. Phoenix design team</span>
<span class="sd">         MUST attend this meeting.\\nRSVP to team leader.</span>

<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>  <span class="c1"># noqa: E501</span>
<span class="p">)</span>

<span class="n">comments_property</span> <span class="o">=</span> <span class="n">multi_text_property</span><span class="p">(</span>
    <span class="s2">&quot;COMMENT&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;COMMENT is used to specify a comment to the calendar user.</span>

<span class="sd">Purpose:</span>
<span class="sd">    This property specifies non-processing information intended</span>
<span class="sd">    to provide a comment to the calendar user.</span>

<span class="sd">Conformance:</span>
<span class="sd">    In :rfc:`5545`, this property can be specified multiple times in</span>
<span class="sd">    &quot;VEVENT&quot;, &quot;VTODO&quot;, &quot;VJOURNAL&quot;, and &quot;VFREEBUSY&quot; calendar components</span>
<span class="sd">    as well as in the &quot;STANDARD&quot; and &quot;DAYLIGHT&quot; sub-components.</span>
<span class="sd">    In :rfc:`7953`, this property can be specified multiple times in</span>
<span class="sd">    &quot;VAVAILABILITY&quot; and &quot;VAVAILABLE&quot;.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, alternate text</span>
<span class="sd">    representation, and language property parameters can be specified</span>
<span class="sd">    on this property.</span>

<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_organizer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vCalAddress</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ORGANIZER defines the organizer for a calendar component.</span>

<span class="sd">    Property Parameters:</span>
<span class="sd">        IANA, non-standard, language, common name,</span>
<span class="sd">        directory entry reference, and sent-by property parameters can be</span>
<span class="sd">        specified on this property.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property MUST be specified in an iCalendar object</span>
<span class="sd">        that specifies a group-scheduled calendar entity.  This property</span>
<span class="sd">        MUST be specified in an iCalendar object that specifies the</span>
<span class="sd">        publication of a calendar user&#39;s busy time.  This property MUST</span>
<span class="sd">        NOT be specified in an iCalendar object that specifies only a time</span>
<span class="sd">        zone definition or that defines calendar components that are not</span>
<span class="sd">        group-scheduled components, but are components only on a single</span>
<span class="sd">        user&#39;s calendar.</span>

<span class="sd">    Description:</span>
<span class="sd">        This property is specified within the &quot;VEVENT&quot;,</span>
<span class="sd">        &quot;VTODO&quot;, and &quot;VJOURNAL&quot; calendar components to specify the</span>
<span class="sd">        organizer of a group-scheduled calendar entity.  The property is</span>
<span class="sd">        specified within the &quot;VFREEBUSY&quot; calendar component to specify the</span>
<span class="sd">        calendar user requesting the free or busy time.  When publishing a</span>
<span class="sd">        &quot;VFREEBUSY&quot; calendar component, the property is used to specify</span>
<span class="sd">        the calendar that the published busy time came from.</span>

<span class="sd">        The property has the property parameters &quot;CN&quot;, for specifying the</span>
<span class="sd">        common or display name associated with the &quot;Organizer&quot;, &quot;DIR&quot;, for</span>
<span class="sd">        specifying a pointer to the directory information associated with</span>
<span class="sd">        the &quot;Organizer&quot;, &quot;SENT-BY&quot;, for specifying another calendar user</span>
<span class="sd">        that is acting on behalf of the &quot;Organizer&quot;.  The non-standard</span>
<span class="sd">        parameters may also be specified on this property.  If the</span>
<span class="sd">        &quot;LANGUAGE&quot; property parameter is specified, the identified</span>
<span class="sd">        language applies to the &quot;CN&quot; parameter value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ORGANIZER&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_set_organizer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vCalAddress</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the value.&quot;&quot;&quot;</span>
    <span class="n">_del_organizer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;ORGANIZER&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_del_organizer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete the value.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ORGANIZER&quot;</span><span class="p">)</span>


<span class="n">organizer_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_organizer</span><span class="p">,</span> <span class="n">_set_organizer</span><span class="p">,</span> <span class="n">_del_organizer</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">single_string_enum_property</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">StrEnum</span><span class="p">],</span> <span class="n">default</span><span class="p">:</span> <span class="n">StrEnum</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a property to access a single string value and convert it to an enum.&quot;&quot;&quot;</span>
    <span class="n">prop</span> <span class="o">=</span> <span class="n">single_string_property</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">docs</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StrEnum</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">return</span> <span class="n">enum</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">StrEnum</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the value.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="p">,</span> <span class="n">fset</span><span class="p">,</span> <span class="n">prop</span><span class="o">.</span><span class="n">fdel</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">docs</span><span class="p">)</span>


<span class="n">busy_type_property</span> <span class="o">=</span> <span class="n">single_string_enum_property</span><span class="p">(</span>
    <span class="s2">&quot;BUSYTYPE&quot;</span><span class="p">,</span>
    <span class="n">BUSYTYPE</span><span class="p">,</span>
    <span class="n">BUSYTYPE</span><span class="o">.</span><span class="n">BUSY_UNAVAILABLE</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;BUSYTYPE specifies the default busy time type.</span>

<span class="sd">Returns:</span>
<span class="sd">    :class:`icalendar.enums.BUSYTYPE`</span>

<span class="sd">Description:</span>
<span class="sd">    This property is used to specify the default busy time</span>
<span class="sd">    type. The values correspond to those used by the FBTYPE&quot;</span>
<span class="sd">    parameter used on a &quot;FREEBUSY&quot; property, with the exception that</span>
<span class="sd">    the &quot;FREE&quot; value is not used in this property.  If not specified</span>
<span class="sd">    on a component that allows this property, the default is &quot;BUSY-</span>
<span class="sd">    UNAVAILABLE&quot;.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">priority_property</span> <span class="o">=</span> <span class="n">single_int_property</span><span class="p">(</span>
    <span class="s2">&quot;PRIORITY&quot;</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Conformance:</span>
<span class="sd">    This property can be specified in &quot;VEVENT&quot; and &quot;VTODO&quot; calendar components</span>
<span class="sd">    according to :rfc:`5545`.</span>
<span class="sd">    :rfc:`7953` adds this property to &quot;VAVAILABILITY&quot;.</span>

<span class="sd">Description:</span>
<span class="sd">    This priority is specified as an integer in the range 0</span>
<span class="sd">    to 9.  A value of 0 specifies an undefined priority.  A value of 1</span>
<span class="sd">    is the highest priority.  A value of 2 is the second highest</span>
<span class="sd">    priority.  Subsequent numbers specify a decreasing ordinal</span>
<span class="sd">    priority.  A value of 9 is the lowest priority.</span>

<span class="sd">    A CUA with a three-level priority scheme of &quot;HIGH&quot;, &quot;MEDIUM&quot;, and</span>
<span class="sd">    &quot;LOW&quot; is mapped into this property such that a property value in</span>
<span class="sd">    the range of 1 to 4 specifies &quot;HIGH&quot; priority.  A value of 5 is</span>
<span class="sd">    the normal or &quot;MEDIUM&quot; priority.  A value in the range of 6 to 9</span>
<span class="sd">    is &quot;LOW&quot; priority.</span>

<span class="sd">    A CUA with a priority schema of &quot;A1&quot;, &quot;A2&quot;, &quot;A3&quot;, &quot;B1&quot;, &quot;B2&quot;, ...,</span>
<span class="sd">    &quot;C3&quot; is mapped into this property such that a property value of 1</span>
<span class="sd">    specifies &quot;A1&quot;, a property value of 2 specifies &quot;A2&quot;, a property</span>
<span class="sd">    value of 3 specifies &quot;A3&quot;, and so forth up to a property value of</span>
<span class="sd">    9 specifies &quot;C3&quot;.</span>

<span class="sd">    Other integer values are reserved for future use.</span>

<span class="sd">    Within a &quot;VEVENT&quot; calendar component, this property specifies a</span>
<span class="sd">    priority for the event.  This property may be useful when more</span>
<span class="sd">    than one event is scheduled for a given time period.</span>

<span class="sd">    Within a &quot;VTODO&quot; calendar component, this property specified a</span>
<span class="sd">    priority for the to-do.  This property is useful in prioritizing</span>
<span class="sd">    multiple action items for a given time period.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">class_property</span> <span class="o">=</span> <span class="n">single_string_enum_property</span><span class="p">(</span>
    <span class="s2">&quot;CLASS&quot;</span><span class="p">,</span>
    <span class="n">CLASS</span><span class="p">,</span>
    <span class="n">CLASS</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CLASS specifies the class of the calendar component.</span>

<span class="sd">Returns:</span>
<span class="sd">    :class:`icalendar.enums.CLASS`</span>

<span class="sd">Description:</span>
<span class="sd">    An access classification is only one component of the</span>
<span class="sd">    general security system within a calendar application.  It</span>
<span class="sd">    provides a method of capturing the scope of the access the</span>
<span class="sd">    calendar owner intends for information within an individual</span>
<span class="sd">    calendar entry.  The access classification of an individual</span>
<span class="sd">    iCalendar component is useful when measured along with the other</span>
<span class="sd">    security components of a calendar system (e.g., calendar user</span>
<span class="sd">    authentication, authorization, access rights, access role, etc.).</span>
<span class="sd">    Hence, the semantics of the individual access classifications</span>
<span class="sd">    cannot be completely defined by this memo alone.  Additionally,</span>
<span class="sd">    due to the &quot;blind&quot; nature of most exchange processes using this</span>
<span class="sd">    memo, these access classifications cannot serve as an enforcement</span>
<span class="sd">    statement for a system receiving an iCalendar object.  Rather,</span>
<span class="sd">    they provide a method for capturing the intention of the calendar</span>
<span class="sd">    owner for the access to the calendar component.  If not specified</span>
<span class="sd">    in a component that allows this property, the default value is</span>
<span class="sd">    PUBLIC.  Applications MUST treat x-name and iana-token values they</span>
<span class="sd">    don&#39;t recognize the same way as they would the PRIVATE value.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">transparency_property</span> <span class="o">=</span> <span class="n">single_string_enum_property</span><span class="p">(</span>
    <span class="s2">&quot;TRANSP&quot;</span><span class="p">,</span>
    <span class="n">TRANSP</span><span class="p">,</span>
    <span class="n">TRANSP</span><span class="o">.</span><span class="n">OPAQUE</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TRANSP defines whether or not an event is transparent to busy time searches.</span>

<span class="sd">Returns:</span>
<span class="sd">    :class:`icalendar.enums.TRANSP`</span>

<span class="sd">Description:</span>
<span class="sd">    Time Transparency is the characteristic of an event</span>
<span class="sd">    that determines whether it appears to consume time on a calendar.</span>
<span class="sd">    Events that consume actual time for the individual or resource</span>
<span class="sd">    associated with the calendar SHOULD be recorded as OPAQUE,</span>
<span class="sd">    allowing them to be detected by free/busy time searches.  Other</span>
<span class="sd">    events, which do not take up the individual&#39;s (or resource&#39;s) time</span>
<span class="sd">    SHOULD be recorded as TRANSPARENT, making them invisible to free/</span>
<span class="sd">    busy time searches.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">status_property</span> <span class="o">=</span> <span class="n">single_string_enum_property</span><span class="p">(</span>
    <span class="s2">&quot;STATUS&quot;</span><span class="p">,</span>
    <span class="n">STATUS</span><span class="p">,</span>
    <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;STATUS defines the overall status or confirmation for the calendar component.</span>

<span class="sd">Returns:</span>
<span class="sd">    :class:`icalendar.enums.STATUS`</span>

<span class="sd">The default value is ``&quot;&quot;``.</span>

<span class="sd">Description:</span>
<span class="sd">    In a group-scheduled calendar component, the property</span>
<span class="sd">    is used by the &quot;Organizer&quot; to provide a confirmation of the event</span>
<span class="sd">    to the &quot;Attendees&quot;.  For example in a &quot;VEVENT&quot; calendar component,</span>
<span class="sd">    the &quot;Organizer&quot; can indicate that a meeting is tentative,</span>
<span class="sd">    confirmed, or cancelled.  In a &quot;VTODO&quot; calendar component, the</span>
<span class="sd">    &quot;Organizer&quot; can indicate that an action item needs action, is</span>
<span class="sd">    completed, is in process or being worked on, or has been</span>
<span class="sd">    cancelled.  In a &quot;VJOURNAL&quot; calendar component, the &quot;Organizer&quot;</span>
<span class="sd">    can indicate that a journal entry is draft, final, or has been</span>
<span class="sd">    cancelled or removed.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">url_property</span> <span class="o">=</span> <span class="n">single_string_property</span><span class="p">(</span>
    <span class="s2">&quot;URL&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Uniform Resource Locator (URL) associated with the iCalendar object.</span>

<span class="sd">Description:</span>
<span class="sd">    This property may be used in a calendar component to</span>
<span class="sd">    convey a location where a more dynamic rendition of the calendar</span>
<span class="sd">    information associated with the calendar component can be found.</span>
<span class="sd">    This memo does not attempt to standardize the form of the URI, nor</span>
<span class="sd">    the format of the resource pointed to by the property value.  If</span>
<span class="sd">    the URL property and Content-Location MIME header are both</span>
<span class="sd">    specified, they MUST point to the same resource.</span>

<span class="sd">Conformance:</span>
<span class="sd">    This property can be specified once in the &quot;VEVENT&quot;,</span>
<span class="sd">    &quot;VTODO&quot;, &quot;VJOURNAL&quot;, or &quot;VFREEBUSY&quot; calendar components.</span>
<span class="sd">    Since :rfc:`7986`, this property can also be defined on a &quot;VCALENDAR&quot;.</span>

<span class="sd">Example:</span>
<span class="sd">    The following is an example of this property:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        URL:http://example.com/pub/calendars/jsmith/mytime.ics</span>

<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">source_property</span> <span class="o">=</span> <span class="n">single_string_property</span><span class="p">(</span>
    <span class="s2">&quot;SOURCE&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A URI from where calendar data can be refreshed.</span>

<span class="sd">Description:</span>
<span class="sd">    This property identifies a location where a client can</span>
<span class="sd">    retrieve updated data for the calendar.  Clients SHOULD honor any</span>
<span class="sd">    specified &quot;REFRESH-INTERVAL&quot; value when periodically retrieving</span>
<span class="sd">    data.  Note that this property differs from the &quot;URL&quot; property in</span>
<span class="sd">    that &quot;URL&quot; is meant to provide an alternative representation of</span>
<span class="sd">    the calendar data rather than the original location of the data.</span>

<span class="sd">Conformance:</span>
<span class="sd">    This property can be specified once in an iCalendar object.</span>

<span class="sd">Example:</span>
<span class="sd">    The following is an example of this property:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        SOURCE;VALUE=URI:https://example.com/holidays.ics</span>

<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">location_property</span> <span class="o">=</span> <span class="n">multi_language_text_property</span><span class="p">(</span>
    <span class="s2">&quot;LOCATION&quot;</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The intended venue for the activity defined by a calendar component.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, alternate text</span>
<span class="sd">    representation, and language property parameters can be specified</span>
<span class="sd">    on this property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    Since :rfc:`5545`, this property can be specified in &quot;VEVENT&quot; or &quot;VTODO&quot;</span>
<span class="sd">    calendar component.</span>
<span class="sd">    :rfc:`7953` adds this property to &quot;VAVAILABILITY&quot; and &quot;VAVAILABLE&quot;.</span>

<span class="sd">Description:</span>
<span class="sd">    Specific venues such as conference or meeting rooms may</span>
<span class="sd">    be explicitly specified using this property.  An alternate</span>
<span class="sd">    representation may be specified that is a URI that points to</span>
<span class="sd">    directory information with more structured specification of the</span>
<span class="sd">    location.  For example, the alternate representation may specify</span>
<span class="sd">    either an LDAP URL :rfc:`4516` pointing to an LDAP server entry or a</span>
<span class="sd">    CID URL :rfc:`2392` pointing to a MIME body part containing a</span>
<span class="sd">    Virtual-Information Card (vCard) :rfc:`2426` for the location.</span>

<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">contacts_property</span> <span class="o">=</span> <span class="n">multi_text_property</span><span class="p">(</span>
    <span class="s2">&quot;CONTACT&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contact information associated with the calendar component.</span>

<span class="sd">Purpose:</span>
<span class="sd">    This property is used to represent contact information or</span>
<span class="sd">    alternately a reference to contact information associated with the</span>
<span class="sd">    calendar component.</span>

<span class="sd">Property Parameters:</span>
<span class="sd">    IANA, non-standard, alternate text</span>
<span class="sd">    representation, and language property parameters can be specified</span>
<span class="sd">    on this property.</span>

<span class="sd">Conformance:</span>
<span class="sd">    In :rfc:`5545`, this property can be specified in a &quot;VEVENT&quot;, &quot;VTODO&quot;,</span>
<span class="sd">    &quot;VJOURNAL&quot;, or &quot;VFREEBUSY&quot; calendar component.</span>
<span class="sd">    In :rfc:`7953`, this property can be specified in a &quot;VAVAILABILITY&quot;</span>
<span class="sd">    amd &quot;VAVAILABLE&quot; calendar component.</span>

<span class="sd">Description:</span>
<span class="sd">    The property value consists of textual contact</span>
<span class="sd">    information.  An alternative representation for the property value</span>
<span class="sd">    can also be specified that refers to a URI pointing to an</span>
<span class="sd">    alternate form, such as a vCard :rfc:`2426`, for the contact</span>
<span class="sd">    information.</span>

<span class="sd">Example:</span>
<span class="sd">    The following is an example of this property referencing</span>
<span class="sd">    textual contact information:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        CONTACT:Jim Dolittle\\, ABC Industries\\, +1-919-555-1234</span>

<span class="sd">    The following is an example of this property with an alternate</span>
<span class="sd">    representation of an LDAP URI to a directory entry containing the</span>
<span class="sd">    contact information:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        CONTACT;ALTREP=&quot;ldap://example.com:6666/o=ABC%20Industries\\,</span>
<span class="sd">        c=US???(cn=Jim%20Dolittle)&quot;:Jim Dolittle\\, ABC Industries\\,</span>
<span class="sd">        +1-919-555-1234</span>

<span class="sd">    The following is an example of this property with an alternate</span>
<span class="sd">    representation of a MIME body part containing the contact</span>
<span class="sd">    information, such as a vCard :rfc:`2426` embedded in a text/</span>
<span class="sd">    directory media type :rfc:`2425`:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        CONTACT;ALTREP=&quot;CID:part3.msg970930T083000SILVER@example.com&quot;:</span>
<span class="sd">         Jim Dolittle\\, ABC Industries\\, +1-919-555-1234</span>

<span class="sd">    The following is an example of this property referencing a network</span>
<span class="sd">    resource, such as a vCard :rfc:`2426` object containing the contact</span>
<span class="sd">    information:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        CONTACT;ALTREP=&quot;http://example.com/pdi/jdoe.vcf&quot;:Jim</span>
<span class="sd">         Dolittle\\, ABC Industries\\, +1-919-555-1234</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">timezone_datetime_property</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a property to access the values with a proper timezone.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">single_utc_property</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span>


<span class="n">rfc_7953_dtstart_property</span> <span class="o">=</span> <span class="n">timezone_datetime_property</span><span class="p">(</span>
    <span class="s2">&quot;DTSTART&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start of the component.</span>

<span class="sd">    This is almost the same as :attr:`Event.DTSTART` with one exception:</span>
<span class="sd">    The values MUST have a timezone and DATE is not allowed.</span>

<span class="sd">    Description:</span>
<span class="sd">        :rfc:`7953`: If specified, the &quot;DTSTART&quot; and &quot;DTEND&quot; properties in</span>
<span class="sd">        &quot;VAVAILABILITY&quot; components and &quot;AVAILABLE&quot; subcomponents MUST be</span>
<span class="sd">        &quot;DATE-TIME&quot; values specified as either the date with UTC time or</span>
<span class="sd">        the date with local time and a time zone reference.</span>

<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">rfc_7953_dtend_property</span> <span class="o">=</span> <span class="n">timezone_datetime_property</span><span class="p">(</span>
    <span class="s2">&quot;DTEND&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start of the component.</span>

<span class="sd">    This is almost the same as :attr:`Event.DTEND` with one exception:</span>
<span class="sd">    The values MUST have a timezone and DATE is not allowed.</span>

<span class="sd">    Description:</span>
<span class="sd">        :rfc:`7953`: If specified, the &quot;DTSTART&quot; and &quot;DTEND&quot; properties in</span>
<span class="sd">        &quot;VAVAILABILITY&quot; components and &quot;AVAILABLE&quot; subcomponents MUST be</span>
<span class="sd">        &quot;DATE-TIME&quot; values specified as either the date with UTC time or</span>
<span class="sd">        the date with local time and a time zone reference.</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@property</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rfc_7953_duration_property</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the duration of this component.</span>

<span class="sd">    If there is no :attr:`DTEND` or :attr:`DURATION` set, this is None.</span>
<span class="sd">    Otherwise, the duration is calculated from :attr:`DTSTART` and</span>
<span class="sd">    :attr:`DTEND`/:attr:`DURATION`.</span>

<span class="sd">    This is in accordance with :rfc:`7953`:</span>
<span class="sd">    If &quot;DTEND&quot; or &quot;DURATION&quot; are not present, then the end time is unbounded.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DURATION</span>
    <span class="k">if</span> <span class="n">duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">duration</span>
    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DTEND</span>
    <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DTSTART</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">IncompleteComponent</span><span class="p">(</span><span class="s2">&quot;Cannot compute duration without start.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>


<span class="nd">@property</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rfc_7953_end_property</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the duration of this component.</span>

<span class="sd">    If there is no :attr:`DTEND` or :attr:`DURATION` set, this is None.</span>
<span class="sd">    Otherwise, the duration is calculated from :attr:`DTSTART` and</span>
<span class="sd">    :attr:`DTEND`/:attr:`DURATION`.</span>

<span class="sd">    This is in accordance with :rfc:`7953`:</span>
<span class="sd">    If &quot;DTEND&quot; or &quot;DURATION&quot; are not present, then the end time is unbounded.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DURATION</span>
    <span class="k">if</span> <span class="n">duration</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DTSTART</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">IncompleteComponent</span><span class="p">(</span><span class="s2">&quot;Cannot compute end without start.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="n">duration</span>
    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DTEND</span>
    <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">end</span>


<span class="nd">@rfc_7953_end_property</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rfc_7953_end_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">datetime</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">DTEND</span> <span class="o">=</span> <span class="n">value</span>


<span class="nd">@rfc_7953_end_property</span><span class="o">.</span><span class="n">deleter</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rfc_7953_end_property</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">DTEND</span>


<div class="viewcode-block" id="get_start_end_duration_with_validation">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.get_start_end_duration_with_validation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_start_end_duration_with_validation</span><span class="p">(</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span>
    <span class="n">start_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">end_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">component_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate the component and return start, end, and duration.</span>

<span class="sd">    This tests validity according to :rfc:`5545` rules</span>
<span class="sd">    for ``Event`` and ``Todo`` components.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component to validate, either ``Event`` or ``Todo``.</span>
<span class="sd">        start_property: The start property name, ``DTSTART``.</span>
<span class="sd">        end_property: The end property name, either ``DTEND`` for ``Event`` or</span>
<span class="sd">            ``DUE`` for ``Todo``.</span>
<span class="sd">        component_name: The component name for error messages,</span>
<span class="sd">            either ``VEVENT`` or ``VTODO``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (start, end, duration) values from the component.</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidCalendar: If the component violates RFC 5545 constraints.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">start_property</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">end_property</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">DURATION</span>

    <span class="c1"># RFC 5545: Only one of end property and DURATION may be present</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_name</span> <span class="o">=</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">if</span> <span class="n">end_property</span> <span class="o">==</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">else</span> <span class="s2">&quot;DUE&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Only one of </span><span class="si">{</span><span class="n">end_name</span><span class="si">}</span><span class="s2"> and DURATION &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;may be in a </span><span class="si">{</span><span class="n">component_name</span><span class="si">}</span><span class="s2">, not both.&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># RFC 5545: When DTSTART is a date, DURATION must be of days or weeks</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">is_date</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">duration</span><span class="o">.</span><span class="n">seconds</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;When DTSTART is a date, DURATION must be of days or weeks.&quot;</span>
        <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># RFC 5545: DTSTART and end property must be of the same type</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_date</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">!=</span> <span class="n">is_date</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
        <span class="n">end_name</span> <span class="o">=</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">if</span> <span class="n">end_property</span> <span class="o">==</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">else</span> <span class="s2">&quot;DUE&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;DTSTART and </span><span class="si">{</span><span class="n">end_name</span><span class="si">}</span><span class="s2"> must be of the same type, either date or datetime.&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">duration</span></div>



<div class="viewcode-block" id="get_start_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.get_start_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_start_property</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the start property with validation.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component from which to get its start property.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The ``DTSTART`` value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        IncompleteComponent: If no ``DTSTART`` is present.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Trigger validation by calling _get_start_end_duration</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_start_end_duration</span><span class="p">()</span>  <span class="c1"># noqa: SLF001</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;No DTSTART given.&quot;</span>
        <span class="k">raise</span> <span class="n">IncompleteComponent</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">start</span></div>



<div class="viewcode-block" id="get_end_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.get_end_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_end_property</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">end_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the end property with fallback logic for ``Event`` and ``Todo`` components.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component to get end from</span>
<span class="sd">        end_property: The end property name, either ``DTEND`` for ``Event`` or</span>
<span class="sd">            ``DUE`` for ``Todo``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The computed end value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        IncompleteComponent: If the provided information is incomplete</span>
<span class="sd">            to compute the end property.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Trigger validation by calling _get_start_end_duration</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_start_end_duration</span><span class="p">()</span>  <span class="c1"># noqa: SLF001</span>

    <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end_name</span> <span class="o">=</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">if</span> <span class="n">end_property</span> <span class="o">==</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">else</span> <span class="s2">&quot;DUE&quot;</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No </span><span class="si">{</span><span class="n">end_name</span><span class="si">}</span><span class="s2"> or DURATION+DTSTART given.&quot;</span>
            <span class="k">raise</span> <span class="n">IncompleteComponent</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Default behavior: date gets +1 day, datetime gets same time</span>
        <span class="k">if</span> <span class="n">is_date</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">start</span>

    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="n">end_name</span> <span class="o">=</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">if</span> <span class="n">end_property</span> <span class="o">==</span> <span class="s2">&quot;DTEND&quot;</span> <span class="k">else</span> <span class="s2">&quot;DUE&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No </span><span class="si">{</span><span class="n">end_name</span><span class="si">}</span><span class="s2"> or DURATION+DTSTART given.&quot;</span>
        <span class="k">raise</span> <span class="n">IncompleteComponent</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">end</span></div>



<div class="viewcode-block" id="get_duration_property">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.get_duration_property">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_duration_property</span><span class="p">(</span><span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the duration property with fallback calculation from start and end.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component from which to get its duration property.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The duration as a timedelta.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First check if DURATION property is explicitly set</span>
    <span class="k">if</span> <span class="s2">&quot;DURATION&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">component</span><span class="p">[</span><span class="s2">&quot;DURATION&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span>

    <span class="c1"># Fall back to calculated duration from start and end</span>
    <span class="k">return</span> <span class="n">component</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">component</span><span class="o">.</span><span class="n">start</span></div>



<div class="viewcode-block" id="set_duration_with_locking">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.set_duration_with_locking">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">set_duration_with_locking</span><span class="p">(</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">locked</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">],</span>
    <span class="n">end_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the duration with explicit locking behavior for ``Event`` and ``Todo``.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component to modify, either ``Event`` or ``Todo``.</span>
<span class="sd">        duration: The duration to set, or ``None`` to convert to ``DURATION`` property.</span>
<span class="sd">        locked: Which property to keep unchanged, either ``start`` or ``end``.</span>
<span class="sd">        end_property: The end property name, either ``DTEND`` for ``Event`` or</span>
<span class="sd">            ``DUE`` for ``Todo``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert to DURATION property if duration is None</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;DURATION&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># Already has DURATION property</span>
        <span class="n">current_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">duration</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DURATION</span> <span class="o">=</span> <span class="n">current_duration</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Use timedelta, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Validate date/duration compatibility</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">DTSTART</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_date</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="ow">and</span> <span class="n">duration</span><span class="o">.</span><span class="n">seconds</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;When DTSTART is a date, DURATION must be of days or weeks.&quot;</span>
        <span class="k">raise</span> <span class="n">InvalidCalendar</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">locked</span> <span class="o">==</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span>
        <span class="c1"># Keep start locked, adjust end</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Cannot set duration without DTSTART. Set start time first.&quot;</span>
            <span class="k">raise</span> <span class="n">IncompleteComponent</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">end_property</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove end property</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DURATION</span> <span class="o">=</span> <span class="n">duration</span>
    <span class="k">elif</span> <span class="n">locked</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span>
        <span class="c1"># Keep end locked, adjust start</span>
        <span class="n">current_end</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">end</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DTSTART</span> <span class="o">=</span> <span class="n">current_end</span> <span class="o">-</span> <span class="n">duration</span>
        <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">end_property</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove end property</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DURATION</span> <span class="o">=</span> <span class="n">duration</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;locked must be &#39;start&#39; or &#39;end&#39;, not </span><span class="si">{</span><span class="n">locked</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>



<div class="viewcode-block" id="set_start_with_locking">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.set_start_with_locking">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">set_start_with_locking</span><span class="p">(</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">locked</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the start with explicit locking behavior for ``Event`` and ``Todo`` components.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component to modify, either ``Event`` or ``Todo``.</span>
<span class="sd">        start: The start time to set.</span>
<span class="sd">        locked: Which property to keep unchanged, either ``duration``, ``end``,</span>
<span class="sd">            or ``None`` for auto-detect.</span>
<span class="sd">        end_property: The end property name, either ``DTEND`` for ``Event`` or</span>
<span class="sd">            ``DUE`` for ``Todo``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">locked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Auto-detect based on existing properties</span>
        <span class="k">if</span> <span class="s2">&quot;DURATION&quot;</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
            <span class="n">locked</span> <span class="o">=</span> <span class="s2">&quot;duration&quot;</span>
        <span class="k">elif</span> <span class="n">end_property</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
            <span class="n">locked</span> <span class="o">=</span> <span class="s2">&quot;end&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Default to duration if no existing properties</span>
            <span class="n">locked</span> <span class="o">=</span> <span class="s2">&quot;duration&quot;</span>

    <span class="k">if</span> <span class="n">locked</span> <span class="o">==</span> <span class="s2">&quot;duration&quot;</span><span class="p">:</span>
        <span class="c1"># Keep duration locked, adjust end</span>
        <span class="n">current_duration</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">duration</span>
            <span class="k">if</span> <span class="s2">&quot;DURATION&quot;</span> <span class="ow">in</span> <span class="n">component</span> <span class="ow">or</span> <span class="n">end_property</span> <span class="ow">in</span> <span class="n">component</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DTSTART</span> <span class="o">=</span> <span class="n">start</span>
        <span class="k">if</span> <span class="n">current_duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">end_property</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove end property</span>
            <span class="n">component</span><span class="o">.</span><span class="n">DURATION</span> <span class="o">=</span> <span class="n">current_duration</span>
    <span class="k">elif</span> <span class="n">locked</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span>
        <span class="c1"># Keep end locked, adjust duration</span>
        <span class="n">current_end</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">end</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DTSTART</span> <span class="o">=</span> <span class="n">start</span>
        <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;DURATION&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove duration property</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">end_property</span><span class="p">,</span> <span class="n">current_end</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;locked must be &#39;duration&#39;, &#39;end&#39;, or None, not </span><span class="si">{</span><span class="n">locked</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>



<div class="viewcode-block" id="set_end_with_locking">
<a class="viewcode-back" href="../../reference/api/icalendar.attr.html#icalendar.attr.set_end_with_locking">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">set_end_with_locking</span><span class="p">(</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">locked</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">],</span>
    <span class="n">end_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the end with explicit locking behavior for Event and Todo components.</span>

<span class="sd">    Args:</span>
<span class="sd">        component: The component to modify, either ``Event`` or ``Todo``.</span>
<span class="sd">        end: The end time to set.</span>
<span class="sd">        locked: Which property to keep unchanged, either ``start`` or ``duration``.</span>
<span class="sd">        end_property: The end property name, either ``DTEND`` for ``Event`` or ``DUE``</span>
<span class="sd">            for ``Todo``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">locked</span> <span class="o">==</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span>
        <span class="c1"># Keep start locked, adjust duration</span>
        <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;DURATION&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove duration property</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">end_property</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">locked</span> <span class="o">==</span> <span class="s2">&quot;duration&quot;</span><span class="p">:</span>
        <span class="c1"># Keep duration locked, adjust start</span>
        <span class="n">current_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">duration</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DTSTART</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">current_duration</span>
        <span class="n">component</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">end_property</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove end property</span>
        <span class="n">component</span><span class="o">.</span><span class="n">DURATION</span> <span class="o">=</span> <span class="n">current_duration</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;locked must be &#39;start&#39; or &#39;duration&#39;, not </span><span class="si">{</span><span class="n">locked</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_get_images</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Image</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;IMAGE specifies an image associated with the calendar or a calendar component.</span>

<span class="sd">    Description:</span>
<span class="sd">        This property specifies an image for an iCalendar</span>
<span class="sd">        object or a calendar component via a URI or directly with inline</span>
<span class="sd">        data that can be used by calendar user agents when presenting the</span>
<span class="sd">        calendar data to a user.  Multiple properties MAY be used to</span>
<span class="sd">        specify alternative sets of images with, for example, varying</span>
<span class="sd">        media subtypes, resolutions, or sizes.  When multiple properties</span>
<span class="sd">        are present, calendar user agents SHOULD display only one of them,</span>
<span class="sd">        picking one that provides the most appropriate image quality, or</span>
<span class="sd">        display none.  The &quot;DISPLAY&quot; parameter is used to indicate the</span>
<span class="sd">        intended display mode for the image.  The &quot;ALTREP&quot; parameter,</span>
<span class="sd">        defined in :rfc:`5545`, can be used to provide a &quot;clickable&quot; image</span>
<span class="sd">        where the URI in the parameter value can be &quot;launched&quot; by a click</span>
<span class="sd">        on the image in the calendar user agent.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property can be specified multiple times in an</span>
<span class="sd">        iCalendar object or in &quot;VEVENT&quot;, &quot;VTODO&quot;, or &quot;VJOURNAL&quot; calendar</span>
<span class="sd">        components.</span>

<span class="sd">    .. note::</span>

<span class="sd">        At the present moment, this property is read-only. If you require a setter,</span>
<span class="sd">        please open an issue or a pull request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">images</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IMAGE&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">SEQUENCE_TYPES</span><span class="p">):</span>
        <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">images</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">from_property_value</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">]</span>


<span class="n">images_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_images</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_conferences</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Conference</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the CONFERENCE properties as a list.</span>

<span class="sd">    Purpose:</span>
<span class="sd">        This property specifies information for accessing a conferencing system.</span>

<span class="sd">    Conformance:</span>
<span class="sd">        This property can be specified multiple times in a</span>
<span class="sd">        &quot;VEVENT&quot; or &quot;VTODO&quot; calendar component.</span>

<span class="sd">    Description:</span>
<span class="sd">        This property specifies information for accessing a</span>
<span class="sd">        conferencing system for attendees of a meeting or task.  This</span>
<span class="sd">        might be for a telephone-based conference number dial-in with</span>
<span class="sd">        access codes included (such as a tel: URI :rfc:`3966` or a sip: or</span>
<span class="sd">        sips: URI :rfc:`3261`), for a web-based video chat (such as an http:</span>
<span class="sd">        or https: URI :rfc:`7230`), or for an instant messaging group chat</span>
<span class="sd">        room (such as an xmpp: URI :rfc:`5122`).  If a specific URI for a</span>
<span class="sd">        conferencing system is not available, a data: URI :rfc:`2397`</span>
<span class="sd">        containing a text description can be used.</span>

<span class="sd">        A conference system can be a bidirectional communication channel</span>
<span class="sd">        or a uni-directional &quot;broadcast feed&quot;.</span>

<span class="sd">        The &quot;FEATURE&quot; property parameter is used to describe the key</span>
<span class="sd">        capabilities of the conference system to allow a client to choose</span>
<span class="sd">        the ones that give the required level of interaction from a set of</span>
<span class="sd">        multiple properties.</span>

<span class="sd">        The &quot;LABEL&quot; property parameter is used to convey additional</span>
<span class="sd">        details on the use of the URI.  For example, the URIs or access</span>
<span class="sd">        codes for the moderator and attendee of a teleconference system</span>
<span class="sd">        could be different, and the &quot;LABEL&quot; property parameter could be</span>
<span class="sd">        used to &quot;tag&quot; each &quot;CONFERENCE&quot; property to indicate which is</span>
<span class="sd">        which.</span>

<span class="sd">        The &quot;LANGUAGE&quot; property parameter can be used to specify the</span>
<span class="sd">        language used for text values used with this property (as per</span>
<span class="sd">        Section 3.2.10 of :rfc:`5545`).</span>

<span class="sd">    Example:</span>
<span class="sd">        The following are examples of this property:</span>

<span class="sd">        .. code-block:: text</span>

<span class="sd">            CONFERENCE;VALUE=URI;FEATURE=PHONE,MODERATOR;</span>
<span class="sd">             LABEL=Moderator dial-in:tel:+1-412-555-0123,,,654321</span>
<span class="sd">            CONFERENCE;VALUE=URI;FEATURE=PHONE;</span>
<span class="sd">             LABEL=Attendee dial-in:tel:+1-412-555-0123,,,555123</span>
<span class="sd">            CONFERENCE;VALUE=URI;FEATURE=PHONE;</span>
<span class="sd">             LABEL=Attendee dial-in:tel:+1-888-555-0456,,,555123</span>
<span class="sd">            CONFERENCE;VALUE=URI;FEATURE=CHAT;</span>
<span class="sd">             LABEL=Chat room:xmpp:chat-123@conference.example.com</span>
<span class="sd">            CONFERENCE;VALUE=URI;FEATURE=AUDIO,VIDEO;</span>
<span class="sd">             LABEL=Attendee dial-in:https://chat.example.com/audio?id=123456</span>

<span class="sd">        Get all conferences:</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Event</span>
<span class="sd">            &gt;&gt;&gt; event = Event()</span>
<span class="sd">            &gt;&gt;&gt; event.conferences</span>
<span class="sd">            []</span>

<span class="sd">        Set a conference:</span>

<span class="sd">        .. code-block:: pycon</span>

<span class="sd">            &gt;&gt;&gt; from icalendar import Event, Conference</span>
<span class="sd">            &gt;&gt;&gt; event = Event()</span>
<span class="sd">            &gt;&gt;&gt; event.conferences = [</span>
<span class="sd">            ...     Conference(</span>
<span class="sd">            ...         &quot;tel:+1-412-555-0123,,,654321&quot;,</span>
<span class="sd">            ...         feature=&quot;PHONE,MODERATOR&quot;,</span>
<span class="sd">            ...         label=&quot;Moderator dial-in&quot;,</span>
<span class="sd">            ...         language=&quot;EN&quot;,</span>
<span class="sd">            ...     )</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; print(event.to_ical())</span>
<span class="sd">            BEGIN:VEVENT</span>
<span class="sd">            CONFERENCE;FEATURE=&quot;PHONE,MODERATOR&quot;;LABEL=Moderator dial-in;LANGUAGE=EN:t</span>
<span class="sd">             el:+1-412-555-0123,,,654321</span>
<span class="sd">            END:VEVENT</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">conferences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CONFERENCE&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">conferences</span><span class="p">,</span> <span class="n">SEQUENCE_TYPES</span><span class="p">):</span>
        <span class="n">conferences</span> <span class="o">=</span> <span class="p">[</span><span class="n">conferences</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Conference</span><span class="o">.</span><span class="n">from_uri</span><span class="p">(</span><span class="n">conference</span><span class="p">)</span> <span class="k">for</span> <span class="n">conference</span> <span class="ow">in</span> <span class="n">conferences</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_set_conferences</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="n">conferences</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Conference</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the conferences.&quot;&quot;&quot;</span>
    <span class="n">_del_conferences</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">conference</span> <span class="ow">in</span> <span class="n">conferences</span> <span class="ow">or</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;CONFERENCE&quot;</span><span class="p">,</span> <span class="n">conference</span><span class="o">.</span><span class="n">to_uri</span><span class="p">())</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_del_conferences</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all conferences.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;CONFERENCE&quot;</span><span class="p">)</span>


<span class="n">conferences_property</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_conferences</span><span class="p">,</span> <span class="n">_set_conferences</span><span class="p">,</span> <span class="n">_del_conferences</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;attendees_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;busy_type_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;categories_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;class_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;color_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comments_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;conferences_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;contacts_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;create_single_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;descriptions_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;duration_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;exdates_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_duration_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_end_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_start_end_duration_with_validation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_start_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;images_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multi_language_text_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;organizer_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;priority_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property_del_duration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property_doc_duration_template&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property_get_duration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property_set_duration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rdates_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rfc_7953_dtend_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rfc_7953_dtstart_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rfc_7953_duration_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rfc_7953_end_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rrules_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sequence_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_duration_with_locking&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_end_with_locking&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_start_with_locking&quot;</span><span class="p">,</span>
    <span class="s2">&quot;single_int_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;single_utc_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;summary_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;transparency_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;uid_property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;url_property&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2025, Plone Foundation.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>